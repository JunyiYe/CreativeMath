{
  "competition_id": "2006_IMO_Problems",
  "problem_id": 5,
  "difficulty": 8,
  "problem": "Let $P(x)$ be a polynomial of degree $n>1$ with integer coefficients, and let $k$ be a positive integer.  Consider the polynomial $Q(x) = P( P ( \\ldots P(P(x)) \\ldots ))$, where $P$ occurs $k$ times.  Prove that there are at most $n$ integers $t$ such that $Q(t)=t$.",
  "solutions": {
    "Solution": "We use the notation $P^k(x)$ for $Q(x)$.\n The problem statement holds for $k=2$.\n  Suppose that $a_1, \\dotsc, a_k$, $b_1, \\dotsc, b_k$ are integers such that $P(a_j) = b_j$ and $P(b_j) = a_j$ for all indices $j$.  Let the set $\\{ a_1, \\dotsc, a_k, b_1, \\dotsc, b_k \\}$ have $m$ distinct elements.  It suffices to show that $\\deg (P) \\ge m$.\nIf $a_j = b_j$ for all indices $j$, then the polynomial $P(x)-x$ has at least $m$ roots; since $P$ is not linear, it follows that $\\deg P \\ge m$ by the division algorithm.\nSuppose on the other hand that $a_i \\neq b_i$, for some index $i$.  In this case, we claim that $a_j + b_j$ is constant for every index $j$.  Indeed, we note that\n\\[a_j - a_i \\mid P(a_j) - P(a_i) = b_j - b_i \\mid P(b_j) - P(b_i) = a_j - a_i ,\\]\nso $\\lvert a_j - a_i \\rvert = \\lvert b_j - b_i \\rvert$.  Similarly,\n\\[a_j - b_i \\mid P(a_j) - P(b_i) = b_j - a_i \\mid P(b_j) - P(a_i) = a_j - b_i,\\]\nso $\\lvert a_j - b_i \\rvert = \\lvert b_j - a_i \\rvert$.  It follows that $a_j + b_j = a_i + b_i$.\nThis proves our claim.  It follows that the polynomial\n\\[P(x) - \\left( a_i + b_i - x \\right)\\]\nhas at least $m$ roots.  Since $P$ is not linear it follows again that $\\deg P \\ge m$, as desired.  Thus the lemma is proven.  $\\blacksquare$\n If $a$ is a positive integer such that $P^r(a)$ for some positive integer $r$, then $P^2(a) = a$.\n  Let us denote $a_0 = a$, and $a_j = P^j(a)$, for positive integers $j$.  Then $a_0 = a_r$, and\n\\begin{align*} a_1 - a_0 &\\mid P(a_1)- P(a_0) = a_2-a_1 \\\\ &\\mid P(a_2) - P(a_1) = a_3 - a_2 \\\\ &\\vdots \\\\ &\\mid P(a_r)- P(a_{r-1}) = a_1 - a_0 . \\end{align*}\nIt follows that $\\lvert a_{j+1} - a_j \\rvert$ is constant for all indices $j$; let us abbreviate this quantity $d$.  Now, since\n\\[(a_1-a_0) + (a_2-a_1) + \\dotsb + (a_r-a_{r-1}) = a_r-a_0 = 0,\\]\nit follows that for some index $j$,\n\\[a_j - a_{j+1} = -(a_{j+1} - a_{j+2}),\\]\nor $a_j = a_{j+2} = P^2(a_j)$.  Since $a = a_r = P^{r-j}(a_j)$, it then follows that $P^2(a) = a$, as desired.  $\\blacksquare$\nNow, if there are more than $n$ integers $t$ for which $Q(t) = t$, then by Lemma 2, there are more than $n$ integers $t$ such that $P^2(t) = t$, which is a contradiction by Lemma 1.  Thus the problem is solved.  $\\blacksquare$"
  }
}